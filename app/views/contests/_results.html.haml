%article#all-result
  %h2 Leaderboard
  - if can? :download_results, @contest
    = link_to 'Download Hasil',
      contest_download_results_path(contest_id: @contest.id),
      class: 'btn btn-lg'
  .table-responsive
    %table.table.table-hover.table-bordered.contest-results
      %thead
        %tr
          %th Peringkat
          %th Username
          - unless @short_problems.empty?
            %th Bagian A
          - @long_problems.each do |lp|
            %th Bagian B no. #{lp.problem_no}
          %th Total
          %th Penghargaan

      %tbody
        - no_short_problem = @short_problems.empty?
        - @user_contests.each do |uc|
          - user = uc.user
          %tr{ class: row_classes(user, ['clickable-row', uc.award.downcase]), data: { link: user_path(user) } }
            %td= uc.rank
            %td= user.username
            - unless no_short_problem
              %td= uc.short_mark
            - @long_problems.each do |lp|
              - if mask_score?(lp)
                - mask = true
                %td ?
              - else
                %td= score(uc, lp)
            %td= (defined? mask).nil? ? uc.total_mark : '?'
            %td= uc.award
